<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="funkyheatmap">
<title>Recreating the scIB figures • funkyheatmap</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Recreating the scIB figures">
<meta property="og:description" content="funkyheatmap">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">funkyheatmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dynbenchmark.html">Recreating the dynbenchmark figures</a>
    <a class="dropdown-item" href="../articles/executable.html">Standalone executable</a>
    <a class="dropdown-item" href="../articles/mtcars.html">Demo with mtcars</a>
    <a class="dropdown-item" href="../articles/mtcars_images.html">Demo with mtcars and images</a>
    <a class="dropdown-item" href="../articles/nextflow.html">Nextflow module</a>
    <a class="dropdown-item" href="../articles/scIB.html">Recreating the scIB figures</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/funkyheatmap/funkyheatmap/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Recreating the scIB figures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/funkyheatmap/funkyheatmap/blob/HEAD/vignettes/scIB.Rmd" class="external-link"><code>vignettes/scIB.Rmd</code></a></small>
      <div class="d-none name"><code>scIB.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <a href="https://theislab.github.io/scib-reproducibility/" class="external-link">single-cell
integration benchmarking (scIB)</a> project was an effort to evaluate
and compare the performance of methods for integrating single-cell RNA
and ATAC sequencing datasets <span class="citation">(Luecken et al.
2021)</span>. Many of the results were displayed using custom scripts to
create visualisations similar to those produced by
<code>funkyheatmap</code>.</p>
<p>In this vignette we will show how these figures can be reproduced
using <code>funkyheatmap</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://funkyheatmap.github.io/funkyheatmap">funkyheatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary-figure">Summary figure<a class="anchor" aria-label="anchor" href="#summary-figure"></a>
</h2>
<p>The first figure we will recreate is the summary figure showing the
performance of all methods on RNA data. Here is the original for
reference:</p>
<div class="figure">
<img src="https://github.com/theislab/scib-reproducibility/blob/main/data/img/best-RNA.png?raw=true" style="width:100.0%" alt=""><p class="caption">scIB RNA summary figure</p>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>The steps for summarising the raw metric scores are quite complex so
we have included a pre-processed summary table as part of
<code>funkyheatmap</code> which is produced from the files available in
the <a href="https://github.com/theislab/scib-reproducibility" class="external-link">scIB
reproducibility repository</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"scib_summary"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">scib_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 20</span></span>
<span><span class="co">#&gt; Columns: 27</span></span>
<span><span class="co">#&gt; $ method                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "scANVI*", "Scanorama", "scVI", "FastMNN",…</span></span>
<span><span class="co">#&gt; $ output                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Embedding", "Embedding", "Embedding", "Em…</span></span>
<span><span class="co">#&gt; $ features                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "HVG", "HVG", "HVG", "HVG", "HVG", "HVG", …</span></span>
<span><span class="co">#&gt; $ scaling                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Unscaled", "Scaled", "Unscaled", "Unscale…</span></span>
<span><span class="co">#&gt; $ avg_rank                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4.6, 8.0, 9.4, 10.4, 13.2, 13.2, 18.0, 21.…</span></span>
<span><span class="co">#&gt; $ overall_immune_cell_hum     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8217139, 0.8484369, 0.7880395, 0.8456189…</span></span>
<span><span class="co">#&gt; $ overall_immune_cell_hum_mou <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.6275154, 0.6415929, 0.6367120, 0.6049282…</span></span>
<span><span class="co">#&gt; $ overall_lung_atlas          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7557935, 0.7088485, 0.7196019, 0.7083853…</span></span>
<span><span class="co">#&gt; $ overall_mouse_brain         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7331990, 0.6725443, 0.6773415, 0.6062384…</span></span>
<span><span class="co">#&gt; $ overall_pancreas            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7238847, 0.7034837, 0.7134047, 0.7200626…</span></span>
<span><span class="co">#&gt; $ overall_simulations_1_1     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8528483, 0.8522969, 0.8141741, 0.7446178…</span></span>
<span><span class="co">#&gt; $ overall_simulations_2       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7365843, 0.5265792, 0.5022136, 0.7052069…</span></span>
<span><span class="co">#&gt; $ rank_immune_cell_hum        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4, 1, 14, 2, 5, 7, 10, 21, 20, 47, 48, 19,…</span></span>
<span><span class="co">#&gt; $ rank_immune_cell_hum_mou    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4.0, 2.0, 3.0, 9.0, 25.0, 1.0, 15.0, 33.0,…</span></span>
<span><span class="co">#&gt; $ rank_lung_atlas             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3.0, 6.0, 5.0, 7.0, 28.0, 2.0, 15.0, 23.0,…</span></span>
<span><span class="co">#&gt; $ rank_mouse_brain            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 10, 9, 21, 7, 50, 27, 12, 50, 2, 6, 50,…</span></span>
<span><span class="co">#&gt; $ rank_pancreas               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 11, 21, 16, 13, 1, 6, 23, 17, 2, 14, 33, 4…</span></span>
<span><span class="co">#&gt; $ rank_simulations_1_1        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3, 4, 13, 35, 38, 23, 46, 25, 57, 53, 21, …</span></span>
<span><span class="co">#&gt; $ rank_simulations_2          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4, 25, 28, 6, 8, 2, 12, 23, 61, 19, 26, 20…</span></span>
<span><span class="co">#&gt; $ package_score               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8102822, 0.7686694, 0.8831989, 0.7993550…</span></span>
<span><span class="co">#&gt; $ package_rank                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10.0, 7.0, 12.0, 9.0, 11.0, 5.0, 9.0, 7.0,…</span></span>
<span><span class="co">#&gt; $ paper_score                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.43750, 0.87500, 0.65625, 0.25000, 1.0000…</span></span>
<span><span class="co">#&gt; $ paper_rank                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.5, 12.0, 5.0, 1.0, 15.5, 4.0, 1.0, 12.0,…</span></span>
<span><span class="co">#&gt; $ time_score                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.5540645, 0.6355258, 0.5682302, 0.6434753…</span></span>
<span><span class="co">#&gt; $ time_rank                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 21, 40, 29, 41, 47, 7, 41, 40, 25, 54, 55,…</span></span>
<span><span class="co">#&gt; $ memory_score                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.4905173, 0.4046461, 0.5201664, 0.4347876…</span></span>
<span><span class="co">#&gt; $ memory_rank                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 54, 36, 56, 43, 47, 35, 43, 36, 12, 55, 46…</span></span></code></pre></div>
<p>This data frame contains several columns: details of the method
version and output, an average rank used to order the table, overall
scores and ranks for the performance on each dataset, usability scores
and ranks (for the package and paper), and scalability scores and ranks
(for both time and memory). All of these will go into the summary
table.</p>
<p>The dataset requires some preparation for the
<code><a href="../reference/funky_heatmap.html">funky_heatmap()</a></code> function. We will create an <code>id</code>
column using the row numbers (the data is already sorted by performance
ranking). We also create label columns for each of the scores showing
the top 3 performers and relabel some of the columns. Finally, we subset
to a the set of columns we want to plot.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A small helper function for creating rank labels for each column.</span></span>
<span><span class="co"># It takes a scores, ranks them and returns a character vector with labels for</span></span>
<span><span class="co"># the top 3 scores. Any additional arguments are passed to the `rank()`</span></span>
<span><span class="co"># function.</span></span>
<span><span class="va">label_top_3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">scores</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="va">scores</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ranks</span> <span class="op">&lt;=</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span>, <span class="st">""</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">scib_summary_plot</span> <span class="op">&lt;-</span> <span class="va">scib_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Create an ID column showing the final rank</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">scib_summary</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Set the labels for the scaling and features columns</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>      <span class="va">scaling</span>,</span>
<span>      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Unscaled"</span>, <span class="st">"Scaled"</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"+"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>      <span class="va">features</span>,</span>
<span>      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Full"</span>, <span class="st">"HVG"</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FULL"</span>, <span class="st">"HVG"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Create a column with paths to output images</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    output_img <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_match.html" class="external-link">case_match</a></span><span class="op">(</span></span>
<span>      <span class="va">output</span>,</span>
<span>      <span class="st">"Features"</span>  <span class="op">~</span> <span class="st">"images/matrix.png"</span>,</span>
<span>      <span class="st">"Embedding"</span> <span class="op">~</span> <span class="st">"images/embedding.png"</span>,</span>
<span>      <span class="st">"Graph"</span>     <span class="op">~</span> <span class="st">"images/graph.png"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Create rank labels</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    label_pancreas <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="va">rank_pancreas</span><span class="op">)</span>,</span>
<span>    label_lung_atlas <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="va">rank_lung_atlas</span><span class="op">)</span>,</span>
<span>    label_immune_cell_hum <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="va">rank_immune_cell_hum</span><span class="op">)</span>,</span>
<span>    label_immune_cell_hum_mou <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="va">rank_immune_cell_hum_mou</span><span class="op">)</span>,</span>
<span>    label_mouse_brain <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="va">rank_mouse_brain</span><span class="op">)</span>,</span>
<span>    label_simulations_1_1 <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="va">rank_simulations_1_1</span><span class="op">)</span>,</span>
<span>    label_simulations_2 <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="va">rank_simulations_2</span><span class="op">)</span>,</span>
<span>    package_label <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="op">-</span><span class="va">package_rank</span>, ties.method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span>,</span>
<span>    paper_label <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="op">-</span><span class="va">paper_rank</span>, ties.method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span>,</span>
<span>    time_label <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="op">-</span><span class="va">time_rank</span>, ties.method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span>,</span>
<span>    memory_label <span class="op">=</span> <span class="fu">label_top_3</span><span class="op">(</span><span class="op">-</span><span class="va">memory_rank</span>, ties.method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">scib_summary_plot</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 20</span></span>
<span><span class="co">#&gt; Columns: 40</span></span>
<span><span class="co">#&gt; $ method                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "scANVI*", "Scanorama", "scVI", "FastMNN",…</span></span>
<span><span class="co">#&gt; $ output                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Embedding", "Embedding", "Embedding", "Em…</span></span>
<span><span class="co">#&gt; $ features                    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> HVG, HVG, HVG, HVG, HVG, HVG, HVG, HVG, HV…</span></span>
<span><span class="co">#&gt; $ scaling                     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> -, +, -, -, -, -, -, +, +, -, -, +, -, -, …</span></span>
<span><span class="co">#&gt; $ avg_rank                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4.6, 8.0, 9.4, 10.4, 13.2, 13.2, 18.0, 21.…</span></span>
<span><span class="co">#&gt; $ overall_immune_cell_hum     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8217139, 0.8484369, 0.7880395, 0.8456189…</span></span>
<span><span class="co">#&gt; $ overall_immune_cell_hum_mou <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.6275154, 0.6415929, 0.6367120, 0.6049282…</span></span>
<span><span class="co">#&gt; $ overall_lung_atlas          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7557935, 0.7088485, 0.7196019, 0.7083853…</span></span>
<span><span class="co">#&gt; $ overall_mouse_brain         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7331990, 0.6725443, 0.6773415, 0.6062384…</span></span>
<span><span class="co">#&gt; $ overall_pancreas            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7238847, 0.7034837, 0.7134047, 0.7200626…</span></span>
<span><span class="co">#&gt; $ overall_simulations_1_1     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8528483, 0.8522969, 0.8141741, 0.7446178…</span></span>
<span><span class="co">#&gt; $ overall_simulations_2       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7365843, 0.5265792, 0.5022136, 0.7052069…</span></span>
<span><span class="co">#&gt; $ rank_immune_cell_hum        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4, 1, 14, 2, 5, 7, 10, 21, 20, 47, 48, 19,…</span></span>
<span><span class="co">#&gt; $ rank_immune_cell_hum_mou    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4.0, 2.0, 3.0, 9.0, 25.0, 1.0, 15.0, 33.0,…</span></span>
<span><span class="co">#&gt; $ rank_lung_atlas             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3.0, 6.0, 5.0, 7.0, 28.0, 2.0, 15.0, 23.0,…</span></span>
<span><span class="co">#&gt; $ rank_mouse_brain            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 10, 9, 21, 7, 50, 27, 12, 50, 2, 6, 50,…</span></span>
<span><span class="co">#&gt; $ rank_pancreas               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 11, 21, 16, 13, 1, 6, 23, 17, 2, 14, 33, 4…</span></span>
<span><span class="co">#&gt; $ rank_simulations_1_1        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3, 4, 13, 35, 38, 23, 46, 25, 57, 53, 21, …</span></span>
<span><span class="co">#&gt; $ rank_simulations_2          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 4, 25, 28, 6, 8, 2, 12, 23, 61, 19, 26, 20…</span></span>
<span><span class="co">#&gt; $ package_score               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8102822, 0.7686694, 0.8831989, 0.7993550…</span></span>
<span><span class="co">#&gt; $ package_rank                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10.0, 7.0, 12.0, 9.0, 11.0, 5.0, 9.0, 7.0,…</span></span>
<span><span class="co">#&gt; $ paper_score                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.43750, 0.87500, 0.65625, 0.25000, 1.0000…</span></span>
<span><span class="co">#&gt; $ paper_rank                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.5, 12.0, 5.0, 1.0, 15.5, 4.0, 1.0, 12.0,…</span></span>
<span><span class="co">#&gt; $ time_score                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.5540645, 0.6355258, 0.5682302, 0.6434753…</span></span>
<span><span class="co">#&gt; $ time_rank                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 21, 40, 29, 41, 47, 7, 41, 40, 25, 54, 55,…</span></span>
<span><span class="co">#&gt; $ memory_score                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.4905173, 0.4046461, 0.5201664, 0.4347876…</span></span>
<span><span class="co">#&gt; $ memory_rank                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 54, 36, 56, 43, 47, 35, 43, 36, 12, 55, 46…</span></span>
<span><span class="co">#&gt; $ id                          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "2", "3", "4", "5", "6", "7", "8", "9…</span></span>
<span><span class="co">#&gt; $ output_img                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "images/embedding.png", "images/embedding.…</span></span>
<span><span class="co">#&gt; $ label_pancreas              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "1", "3", "", "", "2", "",…</span></span>
<span><span class="co">#&gt; $ label_lung_atlas            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2", "", "3", "", "", "1", "", "", "", "",…</span></span>
<span><span class="co">#&gt; $ label_immune_cell_hum       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "3", "1", "", "2", "", "", "", "", "", "",…</span></span>
<span><span class="co">#&gt; $ label_immune_cell_hum_mou   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "2", "3", "", "", "1", "", "", "", "",…</span></span>
<span><span class="co">#&gt; $ label_mouse_brain           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "", "", "", "", "", "", "", "", "2", …</span></span>
<span><span class="co">#&gt; $ label_simulations_1_1       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "2", "", "", "", "", "", "", "", "", …</span></span>
<span><span class="co">#&gt; $ label_simulations_2         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2", "", "", "3", "", "1", "", "", "", "",…</span></span>
<span><span class="co">#&gt; $ package_label               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "", "", "", "", "1", "", "…</span></span>
<span><span class="co">#&gt; $ paper_label                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "1", "", "", "", "", "3", …</span></span>
<span><span class="co">#&gt; $ time_label                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "", "", "", "", "", "", "", "", "", "2", "…</span></span>
<span><span class="co">#&gt; $ memory_label                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "3", "", "1", "", "", "", "", "", "", "2",…</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="column-information">Column information<a class="anchor" aria-label="anchor" href="#column-information"></a>
</h3>
<p>The first step in plotting the figure is to create a data frame
describing how we want to plot the columns.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">column_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>                           <span class="op">~</span> <span class="va">id</span>,                 <span class="op">~</span> <span class="va">name</span>,  <span class="op">~</span> <span class="va">geom</span>,       <span class="op">~</span> <span class="va">group</span>, <span class="op">~</span> <span class="va">palette</span>, <span class="op">~</span> <span class="va">width</span>, <span class="op">~</span> <span class="va">legend</span>, <span class="op">~</span> <span class="va">hjust</span>, <span class="op">~</span> <span class="va">overlay</span>,</span>
<span>                           <span class="st">"id"</span>,                 <span class="st">"Rank"</span>,  <span class="st">"text"</span>,      <span class="st">"Method"</span>,        <span class="cn">NA</span>,       <span class="fl">1</span>,    <span class="cn">FALSE</span>,       <span class="fl">0</span>,     <span class="cn">FALSE</span>,</span>
<span>                       <span class="st">"method"</span>,               <span class="st">"Method"</span>,  <span class="st">"text"</span>,      <span class="st">"Method"</span>,        <span class="cn">NA</span>,       <span class="fl">5</span>,    <span class="cn">FALSE</span>,       <span class="fl">0</span>,     <span class="cn">FALSE</span>,</span>
<span>                   <span class="st">"output_img"</span>,               <span class="st">"Output"</span>, <span class="st">"image"</span>,      <span class="st">"Method"</span>,        <span class="cn">NA</span>,       <span class="fl">1</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.5</span>,     <span class="cn">FALSE</span>,</span>
<span>                     <span class="st">"features"</span>,             <span class="st">"Features"</span>,  <span class="st">"text"</span>,      <span class="st">"Method"</span>,        <span class="cn">NA</span>,       <span class="fl">2</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.5</span>,     <span class="cn">FALSE</span>,</span>
<span>                      <span class="st">"scaling"</span>,              <span class="st">"Scaling"</span>,  <span class="st">"text"</span>,      <span class="st">"Method"</span>,        <span class="cn">NA</span>,       <span class="fl">1</span>,     <span class="cn">TRUE</span>,     <span class="fl">0.5</span>,     <span class="cn">FALSE</span>,</span>
<span>             <span class="st">"overall_pancreas"</span>,             <span class="st">"Pancreas"</span>,   <span class="st">"bar"</span>,         <span class="st">"RNA"</span>,   <span class="st">"blues"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>               <span class="st">"label_pancreas"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>,         <span class="st">"RNA"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>           <span class="st">"overall_lung_atlas"</span>,                 <span class="st">"Lung"</span>,   <span class="st">"bar"</span>,         <span class="st">"RNA"</span>,   <span class="st">"blues"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>             <span class="st">"label_lung_atlas"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>,         <span class="st">"RNA"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>      <span class="st">"overall_immune_cell_hum"</span>,       <span class="st">"Immune (human)"</span>,   <span class="st">"bar"</span>,         <span class="st">"RNA"</span>,   <span class="st">"blues"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>        <span class="st">"label_immune_cell_hum"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>,         <span class="st">"RNA"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>  <span class="st">"overall_immune_cell_hum_mou"</span>, <span class="st">"Immune (human/mouse)"</span>,   <span class="st">"bar"</span>,         <span class="st">"RNA"</span>,   <span class="st">"blues"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>    <span class="st">"label_immune_cell_hum_mou"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>,         <span class="st">"RNA"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>          <span class="st">"overall_mouse_brain"</span>,          <span class="st">"Mouse brain"</span>,   <span class="st">"bar"</span>,         <span class="st">"RNA"</span>,   <span class="st">"blues"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>            <span class="st">"label_mouse_brain"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>,         <span class="st">"RNA"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>      <span class="st">"overall_simulations_1_1"</span>,                <span class="st">"Sim 1"</span>,   <span class="st">"bar"</span>, <span class="st">"Simulations"</span>,  <span class="st">"greens"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>        <span class="st">"label_simulations_1_1"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>, <span class="st">"Simulations"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>        <span class="st">"overall_simulations_2"</span>,                <span class="st">"Sim 2"</span>,   <span class="st">"bar"</span>, <span class="st">"Simulations"</span>,  <span class="st">"greens"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>          <span class="st">"label_simulations_2"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>, <span class="st">"Simulations"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>                <span class="st">"package_score"</span>,              <span class="st">"Package"</span>,   <span class="st">"bar"</span>,   <span class="st">"Usability"</span>, <span class="st">"oranges"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>                <span class="st">"package_label"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>,   <span class="st">"Usability"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>                  <span class="st">"paper_score"</span>,                <span class="st">"Paper"</span>,   <span class="st">"bar"</span>,   <span class="st">"Usability"</span>, <span class="st">"oranges"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>                  <span class="st">"paper_label"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>,   <span class="st">"Usability"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>                   <span class="st">"time_score"</span>,                 <span class="st">"Time"</span>,   <span class="st">"bar"</span>, <span class="st">"Scalability"</span>,   <span class="st">"greys"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>                   <span class="st">"time_label"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>, <span class="st">"Scalability"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span>                 <span class="st">"memory_score"</span>,               <span class="st">"Memory"</span>,   <span class="st">"bar"</span>, <span class="st">"Scalability"</span>,   <span class="st">"greys"</span>,     <span class="fl">1.5</span>,     <span class="cn">TRUE</span>,      <span class="cn">NA</span>,     <span class="cn">FALSE</span>,</span>
<span>                 <span class="st">"memory_label"</span>,                     <span class="cn">NA</span>,  <span class="st">"text"</span>, <span class="st">"Scalability"</span>,        <span class="cn">NA</span>,      <span class="cn">NA</span>,    <span class="cn">FALSE</span>,     <span class="fl">0.1</span>,      <span class="cn">TRUE</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">column_info</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 27 × 9</span></span></span>
<span><span class="co">#&gt;    id                      name   geom  group palette width legend hjust overlay</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> id                      Rank   text  Meth… <span style="color: #BB0000;">NA</span>        1   FALSE    0   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> method                  Method text  Meth… <span style="color: #BB0000;">NA</span>        5   FALSE    0   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> output_img              Output image Meth… <span style="color: #BB0000;">NA</span>        1   FALSE    0.5 FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> features                Featu… text  Meth… <span style="color: #BB0000;">NA</span>        2   FALSE    0.5 FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> scaling                 Scali… text  Meth… <span style="color: #BB0000;">NA</span>        1   TRUE     0.5 FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> overall_pancreas        Pancr… bar   RNA   blues     1.5 TRUE    <span style="color: #BB0000;">NA</span>   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> label_pancreas          <span style="color: #BB0000;">NA</span>     text  RNA   <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   FALSE    0.1 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> overall_lung_atlas      Lung   bar   RNA   blues     1.5 TRUE    <span style="color: #BB0000;">NA</span>   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> label_lung_atlas        <span style="color: #BB0000;">NA</span>     text  RNA   <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>   FALSE    0.1 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> overall_immune_cell_hum Immun… bar   RNA   blues     1.5 TRUE    <span style="color: #BB0000;">NA</span>   FALSE  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more rows</span></span></span></code></pre></div>
<p>As shown in the other vignettes this table includes the type of geom
for each each column and how they are grouped as well as some
configuration options for how they are displayed. Note that we overlay
the labels for each score over the corresponding bars.</p>
<p>We also describe the various column groups.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">column_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>        <span class="op">~</span> <span class="va">group</span>,     <span class="op">~</span> <span class="va">palette</span>,      <span class="op">~</span> <span class="va">level1</span>,</span>
<span>       <span class="st">"Method"</span>,      <span class="st">"Method"</span>,      <span class="st">"Method"</span>,</span>
<span>          <span class="st">"RNA"</span>,       <span class="st">"blues"</span>,         <span class="st">"RNA"</span>,</span>
<span>  <span class="st">"Simulations"</span>,      <span class="st">"greens"</span>, <span class="st">"Simulations"</span>,</span>
<span>    <span class="st">"Usability"</span>,     <span class="st">"oranges"</span>,   <span class="st">"Usability"</span>,</span>
<span>  <span class="st">"Scalability"</span>,       <span class="st">"greys"</span>, <span class="st">"Scalability"</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">column_groups</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;   group       palette level1     </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Method      Method  Method     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> RNA         blues   RNA        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Simulations greens  Simulations</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Usability   oranges Usability  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Scalability greys   Scalability</span></span></code></pre></div>
<p>There isn’t much customisation here, we are mostly just defining the
labels for each group.</p>
</div>
<div class="section level3">
<h3 id="row-information">Row information<a class="anchor" aria-label="anchor" href="#row-information"></a>
</h3>
<p>We aren’t applying any grouping to the rows so the row information is
very basic.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">row_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">scib_summary_plot</span><span class="op">$</span><span class="va">id</span>, group <span class="op">=</span> <span class="cn">NA_character_</span><span class="op">)</span></span>
<span></span>
<span><span class="va">row_info</span></span>
<span><span class="co">#&gt;    id group</span></span>
<span><span class="co">#&gt; 1   1  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2   2  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3   3  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4   4  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5   5  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6   6  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 7   7  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 8   8  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 9   9  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 10 10  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 11 11  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 12 12  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 13 13  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 14 14  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 15 15  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 16 16  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 17 17  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 18 18  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 19 19  &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 20 20  &lt;NA&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="palettes">Palettes<a class="anchor" aria-label="anchor" href="#palettes"></a>
</h3>
<p>The last thing we define is the palettes. This are very similar to
the default palettes but we include them here as an example and so they
can be easily modified if needed.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">palettes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>   <span class="op">~</span> <span class="va">palette</span>,                                     <span class="op">~</span> <span class="va">colours</span>,</span>
<span>  <span class="st">"features"</span>,                             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>     <span class="st">"blues"</span>, <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"Blues"</span><span class="op">)</span><span class="op">)</span></span>
<span>              <span class="op">)</span><span class="op">(</span><span class="fl">101</span><span class="op">)</span>,</span>
<span>    <span class="st">"greens"</span>, <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"Greens"</span><span class="op">)</span><span class="op">)</span></span>
<span>              <span class="op">)</span><span class="op">(</span><span class="fl">101</span><span class="op">)</span>,</span>
<span>   <span class="st">"oranges"</span>, <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"Oranges"</span><span class="op">)</span><span class="op">)</span></span>
<span>              <span class="op">)</span><span class="op">(</span><span class="fl">101</span><span class="op">)</span>,</span>
<span>     <span class="st">"greys"</span>, <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"Greys"</span><span class="op">)</span><span class="op">)</span></span>
<span>              <span class="op">)</span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="figure">Figure<a class="anchor" aria-label="anchor" href="#figure"></a>
</h3>
<p>Now that we have defined everything we can make the summary
figure.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/funky_heatmap.html">funky_heatmap</a></span><span class="op">(</span></span>
<span>  <span class="va">scib_summary_plot</span>,</span>
<span>  column_info <span class="op">=</span> <span class="va">column_info</span>,</span>
<span>  column_groups <span class="op">=</span> <span class="va">column_groups</span>,</span>
<span>  row_info <span class="op">=</span> <span class="va">row_info</span>,</span>
<span>  palettes <span class="op">=</span> <span class="va">palettes</span>,</span>
<span>  scale_column <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  col_annot_offset <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No legends were provided, trying to automatically infer legends.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Some palettes were not used in the column info, adding legends for them.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Legend 1 did not contain a geom, inferring from the column info.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Legend 1 has geom 'bar', which is not yet implemented. Disabling for now.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Legend 2 did not contain a geom, inferring from the column info.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Legend 2 has geom 'bar', which is not yet implemented. Disabling for now.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Legend 3 did not contain a geom, inferring from the column info.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Legend 3 has geom 'bar', which is not yet implemented. Disabling for now.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Legend 4 did not contain a geom, inferring from the column info.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Legend 4 has geom 'bar', which is not yet implemented. Disabling for now.</span></span>
<span><span class="co">#&gt; Warning in funky_heatmap(scib_summary_plot, column_info = column_info,</span></span>
<span><span class="co">#&gt; column_groups = column_groups, : Argument `col_annot_offset` is deprecated. Use</span></span>
<span><span class="co">#&gt; `position_arguments(col_annot_offset = ...)` instead.</span></span>
<span><span class="co">#&gt; Warning: Removed 12 rows containing missing values (`geom_rect()`).</span></span></code></pre></div>
<p><img src="scIB_files/figure-html/summary-figure-1.png" width="768"></p>
<p>This isn’t exactly like the original figure but it is fairly close.
Most of the differences are cosmetic such as alignment of labels and the
lack of fancy headings (which were created in an image editing program
for the original figure). Perhaps the most significant difference is
that here the bars are coloured by the scores while in the original they
were coloured by rank. This is currently a limitation of
<code><a href="../reference/funky_heatmap.html">funky_heatmap()</a></code> that one variable is use for both colour
and length of the bars. If you compare closely to the original figure
you may also notice some changes in the method ranking compared to the
original figure due to small difference in the pre-processing of the raw
data.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-scib_Luecken2021" class="csl-entry">
Luecken, Malte D, M Büttner, K Chaichoompu, A Danese, M Interlandi, M F
Mueller, D C Strobl, et al. 2021. <span>“<span class="nocase">Benchmarking atlas-level data integration in single-cell
genomics</span>.”</span> <em>Nature Methods</em>, December. <a href="https://doi.org/10.1038/s41592-021-01336-8" class="external-link">https://doi.org/10.1038/s41592-021-01336-8</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Robrecht Cannoodt, Wouter Saelens.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
